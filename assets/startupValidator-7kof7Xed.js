import{b as R,q as p,c as E,d as l,l as I,g as _,e as b,f as T,u as k}from"./index-BQXUvuP9.js";const y={BASE_URL:"/",DEV:!0,MODE:"production",PROD:!1,SSR:!1,VITE_BREVO_API_KEY:"your_brevo_api_key_here",VITE_BREVO_SENDER_EMAIL:"noreply@recaphorizon.com",VITE_BREVO_SENDER_NAME:"RecapHorizon",VITE_ENABLE_PROMPTS_IMPORT:"false",VITE_ENTERPRISE_CONTACT_RECIPIENT:"contact@recaphorizon.com",VITE_FIREBASE_API_KEY:"AIzaSyDJN_IVciPV_2CFhY15xl5gvsyp4qqLPss",VITE_FIREBASE_APP_ID:"1:272169568677:web:33b0ca5dfefd525621004c",VITE_FIREBASE_AUTH_DOMAIN:"recapsmart-ed.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"272169568677",VITE_FIREBASE_PROJECT_ID:"recapsmart-ed",VITE_FIREBASE_STORAGE_BUCKET:"recapsmart-ed.firebasestorage.app",VITE_FUNCTIONS_BASE_URL:"http://127.0.0.1:9000",VITE_GEMINI_API_KEY:"YOUR_GOOGLE_GEMINI_API_KEY_HERE",VITE_HORIZON_EXTRA_AUDIO_MINUTES:"240",VITE_HORIZON_EXTRA_TOKENS:"25000",VITE_STRIPE_HORIZON_PRODUCT_ID:"prod_TQB5uHZaii9ZtV",VITE_STT_MAX_POLL_ATTEMPTS:"200",VITE_STT_MAX_UPLOAD_MB:"4",VITE_STT_POLL_INTERVAL_MS:"3000",VITE_USER_NODE_ENV:"development"},h=class h{static setTranslation(s){this.t=s}static isCacheValid(s){const e=this.apiValidationCache.get(s);return e?Date.now()-e.timestamp<this.CACHE_DURATION:!1}static getCachedResult(s){const e=this.apiValidationCache.get(s);return e?e.result:null}static setCachedResult(s,e){this.apiValidationCache.set(s,{result:e,timestamp:Date.now()})}static async validateGoogleGeminiApi(s){if(!s||s.trim()==="")return{isValid:!1,error:"Google Gemini AI API key is niet geconfigureerd",suggestion:"Voeg een geldige API key toe in de omgevingsvariabelen"};if(!s.startsWith("AIza")||s.length<35)return{isValid:!1,error:"Google Gemini AI API key heeft een ongeldig formaat",suggestion:"Controleer of de API key correct is gekopieerd uit Google AI Studio"};const e=`google_speech_${s.substring(0,10)}`;if(this.isCacheValid(e)){const r=this.getCachedResult(e);if(r)return r}try{const r=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key=${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:"Test"}]}]})});if(r.status===200){const i={isValid:!0};return this.setCachedResult(e,i),i}if(r.status===403){const i={isValid:!1,error:"Google Gemini AI API toegang geweigerd",suggestion:"Controleer of de API key geldig is en Gemini AI API is ingeschakeld"};return this.setCachedResult(e,i),i}if(r.status===429){const i={isValid:!1,error:"Google Gemini AI API quota overschreden",suggestion:"Wacht even en probeer opnieuw, of controleer je quota in Google AI Studio"};return this.setCachedResult(e,i),i}const t={isValid:!0};return this.setCachedResult(e,t),t}catch{const t={isValid:!1,error:"Kan geen verbinding maken met Google Gemini AI API",suggestion:"Controleer je internetverbinding en firewall instellingen"};return this.setCachedResult(e,t),t}}static validateFirebaseConfig(){const e=["VITE_FIREBASE_API_KEY","VITE_FIREBASE_AUTH_DOMAIN","VITE_FIREBASE_PROJECT_ID","VITE_FIREBASE_STORAGE_BUCKET","VITE_FIREBASE_MESSAGING_SENDER_ID","VITE_FIREBASE_APP_ID"].filter(r=>{const t=y[r];return!t||t.trim()===""});return e.length>0?{isValid:!1,error:`Firebase configuratie onvolledig: ${e.join(", ")} ontbreken`,suggestion:"Controleer je .env bestand en zorg dat alle Firebase variabelen zijn ingesteld"}:{isValid:!0}}static async validateAllApis(){const s=this.validateFirebaseConfig(),e={isValid:!0};return{firebase:s,googleSpeech:e,overall:s.isValid&&e.isValid}}};h.apiValidationCache=new Map,h.CACHE_DURATION=300*1e3;let d=h;class m{static async performHealthCheck(s,e){var u;const r=[],t=[],i={basicConnection:!1,readPermissions:!1,writePermissions:!1,indexesWorking:!1},c=R.currentUser,o=c!==null,a=s||(c==null?void 0:c.uid);try{await this.testBasicConnection(),i.basicConnection=!0}catch(n){r.push((e==null?void 0:e("firestoreConnectionError"))||"Cannot connect to Firestore"),t.push((e==null?void 0:e("checkInternetAndConfig"))||"Check your internet connection and Firebase configuration"),n.code==="permission-denied"&&t.push((e==null?void 0:e("checkFirestoreSecurityRules"))||"Check Firestore security rules")}if(o&&a)try{await this.testReadPermissions(a,e),i.readPermissions=!0}catch(n){r.push((e==null?void 0:e("firestoreReadPermissionsError"))||"No read permissions for Firestore"),t.push((e==null?void 0:e("checkFirestoreReadRules"))||"Check Firestore security rules for reading"),n.code==="permission-denied"&&t.push((e==null?void 0:e("ensureUserLoggedInWithAccess"))||"Make sure user is logged in and has access to their own data")}else r.push((e==null?void 0:e("firestoreSkippingAuthTests"))||"Skipping permission tests - authentication required"),t.push((e==null?void 0:e("firestoreAuthenticationRequired"))||"Please log in to access all database features"),i.readPermissions=!0;if(o&&a)try{await this.testWritePermissions(a,e),i.writePermissions=!0}catch(n){n.code==="permission-denied"?i.writePermissions=!0:(r.push((e==null?void 0:e("noWritePermissionsForFirestore"))||"No write permissions for Firestore"),t.push((e==null?void 0:e("checkFirestoreSecurityRules"))||"Check Firestore security rules"))}if(o&&a)try{await this.testIndexes(a),i.indexesWorking=!0}catch(n){r.push((e==null?void 0:e("firestoreIndexesNotWorking"))||"Firestore indexes not working correctly"),t.push((e==null?void 0:e("checkFirebaseConsoleForIndexes"))||"Check Firebase Console for missing indexes"),(u=n.message)!=null&&u.includes("index")&&t.push((e==null?void 0:e("createCompositeIndexes"))||"Create the required composite indexes in Firebase Console")}else i.indexesWorking=!0;return{isHealthy:i.basicConnection&&i.readPermissions&&i.writePermissions,issues:r,suggestions:t,testResults:i}}static async testBasicConnection(){try{const s=p(E(l,"users"),I(1));await _(s)}catch(s){if(s.code==="permission-denied")return;throw s}}static async testReadPermissions(s,e){if(!s)throw new Error((e==null?void 0:e("userIdRequiredForReadTest"))||"User ID required for read permission test")}static async testWritePermissions(s,e){if(!s)throw new Error((e==null?void 0:e("userIdRequiredForWriteTest"))||"User ID required for write permission test");const r=b(l,"users",s);try{if((await T(r)).exists()){const i={lastHealthCheck:new Date().toISOString()};await k(r,i)}else return}catch(t){throw t}}static async testIndexes(s){if(s)try{const e=p(E(l,"transcripts"),I(1));await _(e)}catch(e){if(e.code==="permission-denied")return;throw e}}static async quickConnectivityTest(){try{const s=p(E(l,"users"),I(1));return await _(s),!0}catch(s){return s.code==="permission-denied"}}static diagnoseFirestoreError(s,e){const r=s.code||s.name||"unknown",t=s.message||String(s);let i=(e==null?void 0:e("firestoreGenericError"))||"There is a problem with the database connection",c=`Error: ${r} - ${t}`,o=[];switch(r){case"permission-denied":i=(e==null?void 0:e("firestorePermissionDenied"))||"No access to the database. Please log in again.",o=["Log out and log in again","Check if your account is active","Contact support if the problem persists"];break;case"unavailable":case"deadline-exceeded":i=(e==null?void 0:e("firestoreDatabaseUnavailable"))||"Database temporarily unavailable. Please try again in a few minutes.",o=["Wait 2-3 minutes and try again","Check your internet connection","Reload the page if the problem persists"];break;case"failed-precondition":i=(e==null?void 0:e("firestoreConfigurationError"))||"Database configuration problem. Please contact support.",o=["Contact the administrator","Mention this error code: failed-precondition"];break;case"resource-exhausted":i=(e==null?void 0:e("firestoreQuotaExceeded"))||"Database quota exceeded. Please try again later.",o=["Wait a few hours and try again","Contact support for quota increase"];break;default:t.includes("ERR_ABORTED")?(i=(e==null?void 0:e("firestoreConnectionInterrupted"))||"Connection interrupted. Check your internet connection.",o=["Check your internet connection","Reload the page","Try a different browser if the problem persists"]):t.includes("network")&&(i=(e==null?void 0:e("firestoreNetworkError"))||"Network problem. Check your internet connection.",o=["Check your internet connection","Try again in a few minutes"]);break}return{userMessage:i,technicalDetails:c,suggestedActions:o}}}const g=class g{static async validateStartup(s,e){const r=`startup_${s||"anonymous"}`,t=this.validationCache.get(r);if(t&&Date.now()-t.timestamp<this.CACHE_DURATION)return t.result;const i=[],c=[],o=[],a={firebase:!1,firestore:!1,googleSpeechApi:!1};try{const n=d.validateFirebaseConfig();n.isValid?a.firebase=!0:(i.push(n.error||"Firebase configuratie ongeldig"),n.suggestion&&o.push(n.suggestion))}catch{i.push((e==null?void 0:e("firebaseConfigValidationFailed","Firebase configuratie kan niet worden gevalideerd"))||"Firebase configuratie kan niet worden gevalideerd")}try{const n=await m.performHealthCheck(s,e);n.isHealthy?a.firestore=!0:(n.testResults.basicConnection?c.push(...n.issues):i.push(...n.issues),o.push(...n.suggestions),n.issues.length>0)}catch(n){i.push((e==null?void 0:e("firestoreHealthCheckFailed"))||"Firestore health check failed");const A=m.diagnoseFirestoreError(n,e);o.push(...A.suggestedActions)}a.googleSpeechApi=!0,this.performEnvironmentChecks(c,o,e);const f=a.firebase&&i.length===0;f&&c.length>0;const u={isReady:f,criticalIssues:i,warnings:c,services:a,recommendations:o};return this.validationCache.set(r,{result:u,timestamp:Date.now()}),u}static async quickStartupCheck(s){try{return!(!d.validateFirebaseConfig().isValid||!await m.quickConnectivityTest())}catch{return!1}}static performEnvironmentChecks(s,e,r){typeof navigator<"u"&&((!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)&&(s.push("MediaDevices API niet beschikbaar - audio opname werkt mogelijk niet"),e.push("Gebruik een moderne browser die MediaDevices API ondersteunt")),window.MediaRecorder||(s.push("MediaRecorder API niet beschikbaar - audio opname werkt niet"),e.push("Gebruik een browser die MediaRecorder API ondersteunt")))}static generateStartupReport(s){let e=`ðŸ“‹ **RecapHorizon Startup Report**

`;return s.isReady?e+=`âœ… **Status**: Applicatie is klaar voor gebruik

`:e+=`âŒ **Status**: Kritieke problemen gevonden

`,e+=`ðŸ”§ **Services Status**:
`,e+=`- Firebase: ${s.services.firebase?"âœ…":"âŒ"}
`,e+=`- Firestore: ${s.services.firestore?"âœ…":"âŒ"}
`,e+=`- Google Gemini AI API: ${s.services.googleSpeechApi?"âœ…":"âš ï¸"}

`,s.criticalIssues.length>0&&(e+=`ðŸš¨ **Kritieke Problemen**:
`,s.criticalIssues.forEach(r=>{e+=`- ${r}
`}),e+=`
`),s.warnings.length>0&&(e+=`âš ï¸ **Waarschuwingen**:
`,s.warnings.forEach(r=>{e+=`- ${r}
`}),e+=`
`),s.recommendations.length>0&&(e+=`ðŸ’¡ **Aanbevelingen**:
`,s.recommendations.forEach(r=>{e+=`- ${r}
`})),e}};g.validationCache=new Map,g.CACHE_DURATION=180*1e3;let C=g;export{C as StartupValidator};
