import{b as C,q as I,c as g,d,l as _,g as p,e as b,f as V,u as S}from"./index-BJ2LnJ9P.js";const T={BASE_URL:"/",DEV:!0,MODE:"production",PROD:!1,SSR:!1,VITE_BREVO_API_KEY:"your_brevo_api_key_here",VITE_BREVO_SENDER_EMAIL:"noreply@recaphorizon.com",VITE_BREVO_SENDER_NAME:"RecapHorizon",VITE_ENTERPRISE_CONTACT_RECIPIENT:"contact@recaphorizon.com",VITE_FIREBASE_API_KEY:"AIzaSyDJN_IVciPV_2CFhY15xl5gvsyp4qqLPss",VITE_FIREBASE_APP_ID:"1:272169568677:web:33b0ca5dfefd525621004c",VITE_FIREBASE_AUTH_DOMAIN:"recapsmart-ed.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"272169568677",VITE_FIREBASE_PROJECT_ID:"recapsmart-ed",VITE_FIREBASE_STORAGE_BUCKET:"recapsmart-ed.firebasestorage.app",VITE_FIRECRAWL_API_KEY:"fc-e5d60c40c31342b4a454042c5c3b7763",VITE_GEMINI_API_KEY:"AIzaSyCeQeeKpIA4zLyp2UFjE2-VVNdcjWKdkLk",VITE_GOOGLE_CLOUD_API_KEY:"AIzaSyCeQeeKpIA4zLyp2UFjE2-VVNdcjWKdkLk",VITE_MAILERSEND_API_KEY:"mlsn.75971819f7fce139fb500dd12f9fc507de885750e2b84fe5bb12c2c57ef47c2f",VITE_MAILERSEND_SENDER_EMAIL:"noreply@trial.mailersend.com",VITE_MAILERSEND_SENDER_NAME:"RecapHorizon",VITE_USER_NODE_ENV:"development"},E=class E{static setTranslation(s){this.t=s}static isCacheValid(s){const e=this.apiValidationCache.get(s);return e?Date.now()-e.timestamp<this.CACHE_DURATION:!1}static getCachedResult(s){const e=this.apiValidationCache.get(s);return e?e.result:null}static setCachedResult(s,e){this.apiValidationCache.set(s,{result:e,timestamp:Date.now()})}static async validateGoogleGeminiApi(s){if(!s||s.trim()==="")return{isValid:!1,error:"Google Gemini AI API key is niet geconfigureerd",suggestion:"Voeg een geldige API key toe in de omgevingsvariabelen"};if(!s.startsWith("AIza")||s.length<35)return{isValid:!1,error:"Google Gemini AI API key heeft een ongeldig formaat",suggestion:"Controleer of de API key correct is gekopieerd uit Google AI Studio"};const e=`google_speech_${s.substring(0,10)}`;if(this.isCacheValid(e)){const r=this.getCachedResult(e);if(r)return r}try{const r=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key=${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:"Test"}]}]})});if(r.status===200){const i={isValid:!0};return this.setCachedResult(e,i),i}if(r.status===403){const i={isValid:!1,error:"Google Gemini AI API toegang geweigerd",suggestion:"Controleer of de API key geldig is en Gemini AI API is ingeschakeld"};return this.setCachedResult(e,i),i}if(r.status===429){const i={isValid:!1,error:"Google Gemini AI API quota overschreden",suggestion:"Wacht even en probeer opnieuw, of controleer je quota in Google AI Studio"};return this.setCachedResult(e,i),i}const t={isValid:!0};return this.setCachedResult(e,t),t}catch{const t={isValid:!1,error:"Kan geen verbinding maken met Google Gemini AI API",suggestion:"Controleer je internetverbinding en firewall instellingen"};return this.setCachedResult(e,t),t}}static validateFirebaseConfig(){const e=["VITE_FIREBASE_API_KEY","VITE_FIREBASE_AUTH_DOMAIN","VITE_FIREBASE_PROJECT_ID","VITE_FIREBASE_STORAGE_BUCKET","VITE_FIREBASE_MESSAGING_SENDER_ID","VITE_FIREBASE_APP_ID"].filter(r=>{const t=T[r];return!t||t.trim()===""});return e.length>0?{isValid:!1,error:`Firebase configuratie onvolledig: ${e.join(", ")} ontbreken`,suggestion:"Controleer je .env bestand en zorg dat alle Firebase variabelen zijn ingesteld"}:{isValid:!0}}static async validateAllApis(){const s=this.validateFirebaseConfig(),e={isValid:!0};return{firebase:s,googleSpeech:e,overall:s.isValid&&e.isValid}}};E.apiValidationCache=new Map,E.CACHE_DURATION=300*1e3;let u=E;class A{static async performHealthCheck(s,e){var l;const r=[],t=[],i={basicConnection:!1,readPermissions:!1,writePermissions:!1,indexesWorking:!1},o=C.currentUser,a=o!==null,c=s||(o==null?void 0:o.uid);try{await this.testBasicConnection(),i.basicConnection=!0}catch(n){r.push((e==null?void 0:e("firestoreConnectionError"))||"Cannot connect to Firestore"),t.push((e==null?void 0:e("checkInternetAndConfig"))||"Check your internet connection and Firebase configuration"),n.code==="permission-denied"&&t.push((e==null?void 0:e("checkFirestoreSecurityRules"))||"Check Firestore security rules")}if(a&&c)try{await this.testReadPermissions(c,e),i.readPermissions=!0}catch(n){r.push((e==null?void 0:e("firestoreReadPermissionsError"))||"No read permissions for Firestore"),t.push((e==null?void 0:e("checkFirestoreReadRules"))||"Check Firestore security rules for reading"),n.code==="permission-denied"&&t.push((e==null?void 0:e("ensureUserLoggedInWithAccess"))||"Make sure user is logged in and has access to their own data")}else r.push((e==null?void 0:e("firestoreSkippingAuthTests"))||"Skipping permission tests - authentication required"),t.push((e==null?void 0:e("firestoreAuthenticationRequired"))||"Please log in to access all database features"),i.readPermissions=!0;if(a&&c)try{await this.testWritePermissions(c,e),i.writePermissions=!0}catch(n){n.code==="permission-denied"?i.writePermissions=!0:(r.push((e==null?void 0:e("noWritePermissionsForFirestore"))||"No write permissions for Firestore"),t.push((e==null?void 0:e("checkFirestoreSecurityRules"))||"Check Firestore security rules"))}if(a&&c)try{await this.testIndexes(c),i.indexesWorking=!0}catch(n){r.push((e==null?void 0:e("firestoreIndexesNotWorking"))||"Firestore indexes not working correctly"),t.push((e==null?void 0:e("checkFirebaseConsoleForIndexes"))||"Check Firebase Console for missing indexes"),(l=n.message)!=null&&l.includes("index")&&t.push((e==null?void 0:e("createCompositeIndexes"))||"Create the required composite indexes in Firebase Console")}else i.indexesWorking=!0;return{isHealthy:i.basicConnection&&i.readPermissions&&i.writePermissions,issues:r,suggestions:t,testResults:i}}static async testBasicConnection(){try{const s=I(g(d,"users"),_(1));await p(s)}catch(s){if(s.code==="permission-denied")return;throw s}}static async testReadPermissions(s,e){if(!s)throw new Error((e==null?void 0:e("userIdRequiredForReadTest"))||"User ID required for read permission test")}static async testWritePermissions(s,e){if(!s)throw new Error((e==null?void 0:e("userIdRequiredForWriteTest"))||"User ID required for write permission test");const r=b(d,"users",s);try{if((await V(r)).exists()){const i={lastHealthCheck:new Date().toISOString()};await S(r,i)}else return}catch(t){throw t}}static async testIndexes(s){if(s)try{const e=I(g(d,"transcripts"),_(1));await p(e)}catch(e){if(e.code==="permission-denied")return;throw e}}static async quickConnectivityTest(){try{const s=I(g(d,"users"),_(1));return await p(s),!0}catch(s){return s.code==="permission-denied"}}static diagnoseFirestoreError(s,e){const r=s.code||s.name||"unknown",t=s.message||String(s);let i=(e==null?void 0:e("firestoreGenericError"))||"There is a problem with the database connection",o=`Error: ${r} - ${t}`,a=[];switch(r){case"permission-denied":i=(e==null?void 0:e("firestorePermissionDenied"))||"No access to the database. Please log in again.",a=["Log out and log in again","Check if your account is active","Contact support if the problem persists"];break;case"unavailable":case"deadline-exceeded":i=(e==null?void 0:e("firestoreDatabaseUnavailable"))||"Database temporarily unavailable. Please try again in a few minutes.",a=["Wait 2-3 minutes and try again","Check your internet connection","Reload the page if the problem persists"];break;case"failed-precondition":i=(e==null?void 0:e("firestoreConfigurationError"))||"Database configuration problem. Please contact support.",a=["Contact the administrator","Mention this error code: failed-precondition"];break;case"resource-exhausted":i=(e==null?void 0:e("firestoreQuotaExceeded"))||"Database quota exceeded. Please try again later.",a=["Wait a few hours and try again","Contact support for quota increase"];break;default:t.includes("ERR_ABORTED")?(i=(e==null?void 0:e("firestoreConnectionInterrupted"))||"Connection interrupted. Check your internet connection.",a=["Check your internet connection","Reload the page","Try a different browser if the problem persists"]):t.includes("network")&&(i=(e==null?void 0:e("firestoreNetworkError"))||"Network problem. Check your internet connection.",a=["Check your internet connection","Try again in a few minutes"]);break}return{userMessage:i,technicalDetails:o,suggestedActions:a}}}const y={BASE_URL:"/",DEV:!0,MODE:"production",PROD:!1,SSR:!1,VITE_BREVO_API_KEY:"your_brevo_api_key_here",VITE_BREVO_SENDER_EMAIL:"noreply@recaphorizon.com",VITE_BREVO_SENDER_NAME:"RecapHorizon",VITE_ENTERPRISE_CONTACT_RECIPIENT:"contact@recaphorizon.com",VITE_FIREBASE_API_KEY:"AIzaSyDJN_IVciPV_2CFhY15xl5gvsyp4qqLPss",VITE_FIREBASE_APP_ID:"1:272169568677:web:33b0ca5dfefd525621004c",VITE_FIREBASE_AUTH_DOMAIN:"recapsmart-ed.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"272169568677",VITE_FIREBASE_PROJECT_ID:"recapsmart-ed",VITE_FIREBASE_STORAGE_BUCKET:"recapsmart-ed.firebasestorage.app",VITE_FIRECRAWL_API_KEY:"fc-e5d60c40c31342b4a454042c5c3b7763",VITE_GEMINI_API_KEY:"AIzaSyCeQeeKpIA4zLyp2UFjE2-VVNdcjWKdkLk",VITE_GOOGLE_CLOUD_API_KEY:"AIzaSyCeQeeKpIA4zLyp2UFjE2-VVNdcjWKdkLk",VITE_MAILERSEND_API_KEY:"mlsn.75971819f7fce139fb500dd12f9fc507de885750e2b84fe5bb12c2c57ef47c2f",VITE_MAILERSEND_SENDER_EMAIL:"noreply@trial.mailersend.com",VITE_MAILERSEND_SENDER_NAME:"RecapHorizon",VITE_USER_NODE_ENV:"development"},h=class h{static async validateStartup(s,e){const r=`startup_${s||"anonymous"}`,t=this.validationCache.get(r);if(t&&Date.now()-t.timestamp<this.CACHE_DURATION)return t.result;const i=[],o=[],a=[],c={firebase:!1,firestore:!1,googleSpeechApi:!1};try{const n=u.validateFirebaseConfig();n.isValid?c.firebase=!0:(i.push(n.error||"Firebase configuratie ongeldig"),n.suggestion&&a.push(n.suggestion))}catch{i.push((e==null?void 0:e("firebaseConfigValidationFailed","Firebase configuratie kan niet worden gevalideerd"))||"Firebase configuratie kan niet worden gevalideerd")}try{const n=await A.performHealthCheck(s,e);n.isHealthy?c.firestore=!0:(n.testResults.basicConnection?o.push(...n.issues):i.push(...n.issues),a.push(...n.suggestions),n.issues.length>0)}catch(n){i.push((e==null?void 0:e("firestoreHealthCheckFailed"))||"Firestore health check failed");const R=A.diagnoseFirestoreError(n,e);a.push(...R.suggestedActions)}c.googleSpeechApi=!0,this.performEnvironmentChecks(o,a,e);const f=c.firebase&&i.length===0;f&&o.length>0;const l={isReady:f,criticalIssues:i,warnings:o,services:c,recommendations:a};return this.validationCache.set(r,{result:l,timestamp:Date.now()}),l}static async quickStartupCheck(s){try{return!(!u.validateFirebaseConfig().isValid||!await A.quickConnectivityTest())}catch{return!1}}static performEnvironmentChecks(s,e,r){typeof navigator<"u"&&((!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)&&(s.push("MediaDevices API niet beschikbaar - audio opname werkt mogelijk niet"),e.push("Gebruik een moderne browser die MediaDevices API ondersteunt")),window.MediaRecorder||(s.push("MediaRecorder API niet beschikbaar - audio opname werkt niet"),e.push("Gebruik een browser die MediaRecorder API ondersteunt"))),["VITE_GOOGLE_CLOUD_API_KEY","VITE_RECAPTCHA_SITE_KEY"].forEach(i=>{var o;y[i]||(o=r==null?void 0:r("optionalEnvVarNotSet"))!=null&&o.replace("{varName}",i)||`${i}`})}static generateStartupReport(s){let e=`📋 **RecapHorizon Startup Report**

`;return s.isReady?e+=`✅ **Status**: Applicatie is klaar voor gebruik

`:e+=`❌ **Status**: Kritieke problemen gevonden

`,e+=`🔧 **Services Status**:
`,e+=`- Firebase: ${s.services.firebase?"✅":"❌"}
`,e+=`- Firestore: ${s.services.firestore?"✅":"❌"}
`,e+=`- Google Gemini AI API: ${s.services.googleSpeechApi?"✅":"⚠️"}

`,s.criticalIssues.length>0&&(e+=`🚨 **Kritieke Problemen**:
`,s.criticalIssues.forEach(r=>{e+=`- ${r}
`}),e+=`
`),s.warnings.length>0&&(e+=`⚠️ **Waarschuwingen**:
`,s.warnings.forEach(r=>{e+=`- ${r}
`}),e+=`
`),s.recommendations.length>0&&(e+=`💡 **Aanbevelingen**:
`,s.recommendations.forEach(r=>{e+=`- ${r}
`})),e}};h.validationCache=new Map,h.CACHE_DURATION=180*1e3;let m=h;export{m as StartupValidator};
